{% import_yaml "salt/defaults.yaml" as default_settings %}

{% set distro_map = salt['grains.filter_by']({
    'Debian':  {'salt_master': 'salt-master',
                'salt_minion': 'salt-minion',
                'salt_syndic': 'salt-syndic',
                'salt_cloud': 'salt-cloud',
                'salt_api': 'salt-api',
                'salt_ssh': 'salt-ssh'},
    'Ubuntu':  {'salt_master': 'salt-master',
                'salt_minion': 'salt-minion',
                'salt_syndic': 'salt-syndic',
                'salt_cloud': 'salt-cloud',
                'salt_api': 'salt-api',
                'salt_ssh': 'salt-ssh'},
    'CentOS':  {'salt_master': 'salt-master',
                'salt_minion': 'salt-minion',
                'salt_syndic': 'salt-syndic',
                'salt_cloud': 'salt-cloud',
                'salt_api': 'salt-api',
                'salt_ssh': 'salt-ssh'},
    'Amazon':  {'salt_master': 'salt-master',
                'salt_minion': 'salt-minion',
                'salt_syndic': 'salt-syndic',
                'salt_cloud': 'salt-cloud',
                'salt_api': 'salt-api',
                'salt_ssh': 'salt-ssh'},
    'Fedora':  {'salt_master': 'salt-master',
                'salt_minion': 'salt-minion',
                'salt_syndic': 'salt-syndic',
                'salt_cloud': 'salt-cloud',
                'salt_api': 'salt-api',
                'salt_ssh': 'salt-ssh'},
    'RedHat':  {'salt_master': 'salt-master',
                'salt_minion': 'salt-minion',
                'salt_syndic': 'salt-syndic',
                'salt_cloud': 'salt-cloud',
                'salt_api': 'salt-api',
                'salt_ssh': 'salt-ssh'},
    'Gentoo':  {'salt_master': 'app-admin/salt',
                'salt_minion': 'app-admin/salt',
                'salt_syndic': 'app-admin/salt',
                'salt_api': 'app-admin/salt',
                'salt_cloud': 'app-admin/salt'},
    'Arch':    {'salt_master': 'salt-zmq',
                'salt_minion':  'salt-zmq',
                'salt_syndic':  'salt-zmq',
                'salt_cloud':  'salt-zmq',
                'salt_api': 'salt-zmq',
                'salt_ssh':  'salt-zmq'},
    'Suse':    {'salt_master': 'salt-master',
                'salt_minion':  'salt-minion',
                'salt_syndic':  'salt-syndic',
                'salt_api': 'salt-api',
                'salt_cloud':  'salt-cloud',
                'salt_ssh':  'salt-ssh'},
    'FreeBSD': {'salt_master': 'py27-salt',
                'salt_minion': 'py27-salt',
                'salt_syndic': 'py27-salt',
                'salt_cloud': 'py27-salt',
                'salt_api': 'py27-salt',
                'config_path': '/usr/local/etc/salt',
                'minion_service': 'salt_minion',
                'master_service': 'salt_master',
                'api_service': 'salt_api',
                'syndic_service': 'salt_syndic'},
}, merge=salt['pillar.get']('salt:lookup')) %}

{% do default_settings.salt.update(distro_map) %}

{% set salt_settings = salt['pillar.get']('salt', default=default_settings.salt,
  merge=True) %}
